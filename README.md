# MEDODS


**Используемые технологии:**

- Go
- JWT
- PostgreSQL

**Задание:**

Написать часть сервиса аутентификации.

Два REST маршрута:

- Первый маршрут выдает пару Access, Refresh токенов для пользователя с идентификатором (GUID) указанным в параметре запроса
- Второй маршрут выполняет Refresh операцию на пару Access, Refresh токенов

**Требования:**

Access токен тип JWT, алгоритм SHA512, хранить в базе строго запрещено.

Refresh токен тип произвольный, формат передачи base64, хранится в базе исключительно в виде bcrypt хеша, должен быть защищен от изменения на стороне клиента и попыток повторного использования.

Access, Refresh токены обоюдно связаны, Refresh операцию для Access токена можно выполнить только тем Refresh токеном который был выдан вместе с ним.

Payload токенов должен содержать сведения об ip адресе клиента, которому он был выдан. В случае, если ip адрес изменился, при рефреш операции нужно послать email warning на почту юзера (для упрощения можно использовать моковые данные).

**Результат:**

Результат выполнения задания нужно предоставить в виде исходного кода на Github. Будет плюсом, если получится использовать Docker и покрыть код тестами.

![preview](./img/skyline.png)

### Структура проекта

**CMD:**
    Входная точка приложения, содержит:
- main.go
- скомпилированный файл main.exe

**Config:**
    Содержит структуру, которая отвечает за хранение конфигурационных данных.

**docker-entrypoint-initdb.d:**
    Хранит файл с расширением .sql для Dockerfile, который будет запущен базой данных при создании образа.

**Guid:**
Содержит логику работы с GUID:
- Генерация
- Валидация

**Internal:**
 Внутренняя логика самого приложения, включает в себя работу с сервером, бизнес-логикой, базой данных и токенами.

**Bd:**
    Хранит реализацию работы с БД и интерфейсы запросов.

**Logic:**
    Содержит бизнес-логику приложения. Здесь находится основная логика, управляющая обработкой данных и выполнением задач.

**Server:**
    Отвечает за обработку HTTP-запросов, маршрутизацию и взаимодействие с клиентом. 

**Tokens:**
    Реализует управление токенами, которые используются для аутентификации и авторизации пользователей.

**BuildDocker.sh:**
    Скрипт для сборки Docker-образа.

**runDocker.sh:**
    Скрипт для запуска Docker-контейнера.

**Dockerfile:**
    Файл с инструкциями для создания Docker-образа.

**go.mod:**
    Файл, описывающий зависимости и настройки проекта Go.

**go.sum:**
    Файл с контрольными суммами зависимостей, используемых в проекте.


###  Статистика покрытия тестами
```
go test ./... -cover

        medods/internal/bd              coverage: 0.0% of statements
        medods/config           coverage: 0.0% of statements
        medods/cmd              coverage: 0.0% of statements
ok      medods/guid     (cached)        coverage: 83.9% of statements
ok      medods/internal/bd/postgres     1.279s  coverage: 75.0% of statements
ok      medods/internal/logic   1.286s  coverage: 65.4% of statements        
ok      medods/internal/server  (cached)        coverage: 7.4% of statements 
ok      medods/internal/tokens  (cached)        coverage: 78.6% of statements
```
